<f:comment>
    <!-- 
    This file is part of the TYPO3 CMS project.

    It is free software; you can redistribute it and/or modify it under
    the terms of the GNU General Public License, either version 2
    of the License, or any later version.
     
    For the full copyright and license information, please read the
    LICENSE.txt file that was distributed with this source code.

    The TYPO3 project - inspiring people to share! 
    -->
</f:comment>
{namespace dpf = EWW\Dpf\ViewHelpers}

<ol class="tx-dlf-listview-list">
    <f:for each="{results}" as="entry" iteration="eIterator">
        <f:if condition="{entry._source._dissemination}">
            <f:then>
                <li>
                    <dl>
                        <dd><dpf:calcIndex currentIndex="{eIterator.cycle}" currentPage="{currentPage}" itemsPerPage="{settings.list.paginate.itemsPerPage}" />.
                            <f:link.page pageUid="{settings.landingPage}" additionalParams="{tx_dlf: {id: '{f:uri.page(pageUid:\"{settings.apiPid}\", absolute:1, additionalParams:{tx_dpf: {qid:\"{entry._source.PID}\", action:\"mets\"}})}' } }">
                                {entry._source._dissemination._content.title.0}
                                <f:if condition="{entry._source._dissemination._content.issue}">- {entry._source._dissemination._content.issue}</f:if>
                            </f:link.page>
                        </dd>
                        <dd class="author">
                            <f:if condition="{entry._source._dissemination._content.distribution_date.0}">
                                <f:then>
                                    {entry._source._dissemination._content.author.0}
                                </f:then>
                            </f:if>
                        </dd>
                        <dd class="date">
                            <f:if condition="{entry._source._dissemination._content.distribution_date.0}">
                                <f:then>
                                    <f:format.date date="{entry._source._dissemination._content.distribution_date.0}" format="d.m.Y" />
                                </f:then>
                                <f:else>
                                    -
                                </f:else>
                            </f:if>
                        </dd>
                    </dl>
                </li>
            </f:then>
        </f:if>
    </f:for>
</ol>
